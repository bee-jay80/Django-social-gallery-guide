<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üì∏ Django Social Photo Gallery Project Guide</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

    <style>
        body {
            background-color: #f8f9fa; /* Light background for the page */
        }
        .header-section {
            background-color: #212529; /* Dark background for the main title */
            color: white;
            padding: 40px 0;
            margin-bottom: 30px;
        }
        .code-container {
            border: 1px solid #343a40;
            border-radius: 8px;
            overflow: hidden;
            margin-bottom: 20px;
        }
        pre {
            background-color: #282c34; /* Darker background for code blocks */
            color: #abb2bf;
            padding: 15px;
            margin: 0;
            overflow-x: auto;
            font-size: 0.9em;
            position: relative;
        }
        .section-card {
            margin-bottom: 30px;
            box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.05);
        }
        .copy-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            z-index: 10;
        }
        .list-group-item strong {
            color: #007bff;
        }
    </style>
</head>
<body>

<div class="header-section">
    <div class="container">
        <h1 class="display-4">üì∏ Django Social Photo Gallery Project Guide</h1>
        <p class="lead">Build a social media-style photo gallery web app with Django, including user authentication, image uploads, likes, comments, and user search.</p>
    </div>
</div>

<div class="container">

    <div class="card section-card">
        <div class="card-header bg-primary text-white">
            <h2 class="h4 mb-0">‚ú® 1. Project Overview</h2>
        </div>
        <div class="card-body">
            <p>This guide provides all the necessary code and steps to create a feature-rich photo gallery application.</p>
            <h5>**Key Features:**</h5>
            <ul class="list-group list-group-flush">
                <li class="list-group-item"><strong>User registration and login</strong> (leveraging Django's Auth system).</li>
                <li class="list-group-item"><strong>Personal dashboard</strong> for image management.</li>
                <li class="list-group-item">Authenticated <strong>image upload and deletion</strong>.</li>
                <li class="list-group-item">Social features: <strong>like and comment</strong> on images.</li>
                <li class="list-group-item"><strong>Search and view</strong> other users‚Äô galleries.</li>
            </ul>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-success text-white">
            <h2 class="h4 mb-0">‚öôÔ∏è 2. Prerequisites & Setup</h2>
        </div>
        <div class="card-body">
            <h5>**Requirements:**</h5>
            <ul>
                <li><strong>Python</strong> installed</li>
                <li><strong>pip</strong> package manager</li>
            </ul>

            <h5>**Install Dependencies:**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-bash">pip install django pillow</code></pre>
            </div>

            <h5>**Project Initialization:**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-bash"># 1. Create main project directory
django-admin startproject django_gallery

# 2. Change into project directory
cd django_gallery

# 3. Create the core application
python manage.py startapp gallery</code></pre>
            </div>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-info text-white">
            <h2 class="h4 mb-0">üõ†Ô∏è 3. Configuration & Settings</h2>
        </div>
        <div class="card-body">
            <p>Edit the main project settings file: <strong>`django_gallery/settings.py`</strong>. Insert the highlighted lines below.</p>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-python">import os
from pathlib import Path

# ... (rest of the file)

# 1. Register the application
INSTALLED_APPS = [
    'django.contrib.admin',
    'django.contrib.auth',
    'django.contrib.contenttypes',
    'django.contrib.sessions',
    'django.contrib.messages',
    'django.contrib.staticfiles',
    'gallery',  # &lt;--- Our app
]

# ... (rest of the file)

# 2. Configure media file handling
MEDIA_URL = '/media/'
MEDIA_ROOT = os.path.join(BASE_DIR, 'media') # Use os.path.join for compatibility

# 3. Authentication redirects
LOGIN_REDIRECT_URL = 'dashboard'
LOGIN_URL = 'login'

# 4. Template directories (for base.html)
TEMPLATES = [
    {
        'BACKEND': 'django.template.backends.django.DjangoTemplates',
        'DIRS': [BASE_DIR / 'templates'], # &lt;--- Add this line
        'APP_DIRS': True,
        'OPTIONS': {
            'context_processors': [
                'django.template.context_processors.debug',
                'django.template.context_processors.request',
                'django.contrib.auth.context_processors.auth',
                'django.contrib.messages.context_processors.messages',
            ],
        },
    },
]

# ... (rest of the file)</code></pre>
            </div>
        </div>
    </div>
    
    <div class="card section-card">
        <div class="card-header bg-warning text-dark">
            <h2 class="h4 mb-0">üíæ 4. Data Models</h2>
        </div>
        <div class="card-body">
            <p>Define the database structure in <strong>`gallery/models.py`</strong>.</p>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-python">from django.db import models
from django.contrib.auth.models import User

# --- Core Image Post ---
class ImagePost(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE, related_name='images')
    image = models.ImageField(upload_to='images/')
    caption = models.CharField(max_length=255, blank=True)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"Post by {self.user.username} - {self.caption[:20]}"

# --- Like Feature ---
class Like(models.Model):
    post = models.ForeignKey(ImagePost, on_delete=models.CASCADE, related_name='likes')
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    created_at = models.DateTimeField(auto_now_add=True)

    class Meta:
        unique_together = ('post', 'user')

    def __str__(self):
        return f"{self.user.username} likes {self.post.id}"

# --- Comment Feature ---
class Comment(models.Model):
    post = models.ForeignKey(ImagePost, on_delete=models.CASCADE, related_name='comments')
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    text = models.TextField(max_length=500)
    created_at = models.DateTimeField(auto_now_add=True)

    def __str__(self):
        return f"Comment by {self.user.username} on {self.post.id}"</code></pre>
            </div>

            <h5>**Apply the Models (Migrations):**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-bash">python manage.py makemigrations gallery
python manage.py migrate</code></pre>
            </div>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-secondary text-white">
            <h2 class="h4 mb-0">üìù 5. Forms</h2>
        </div>
        <div class="card-body">
            <p>Create <strong>`gallery/forms.py`</strong> to handle user input for registration, image upload, and comments.</p>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-python">from django import forms
from django.contrib.auth.forms import UserCreationForm
from .models import ImagePost, Comment

# --- 1. User Registration Form ---
class UserRegisterForm(UserCreationForm):
    email = forms.EmailField(required=True)

    class Meta(UserCreationForm.Meta):
        fields = UserCreationForm.Meta.fields + ('email', 'first_name', 'last_name')

# --- 2. Image Upload Form ---
class ImagePostForm(forms.ModelForm):
    class Meta:
        model = ImagePost
        fields = ['image', 'caption']
        widgets = {
            'caption': forms.Textarea(attrs={'rows': 2, 'placeholder': 'Add a caption...'}),
        }

# --- 3. Comment Form ---
class CommentForm(forms.ModelForm):
    class Meta:
        model = Comment
        fields = ['text']
        widgets = {
            'text': forms.TextInput(attrs={'placeholder': 'Leave a comment...', 'class': 'form-control form-control-sm'}),
        }</code></pre>
            </div>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-danger text-white">
            <h2 class="h4 mb-0">üß† 6. Views (Application Logic)</h2>
        </div>
        <div class="card-body">
            <p>Implement the core logic for all features in <strong>`gallery/views.py`</strong>.</p>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-python">from django.shortcuts import render, redirect, get_object_or_404
from django.contrib.auth import login
from django.contrib.auth.decorators import login_required
from django.contrib.auth.models import User
from django.db.models import Q
from .forms import UserRegisterForm, ImagePostForm, CommentForm
from .models import ImagePost, Like, Comment

# --- Authentication ---
def register(request):
    """Handles user registration and automatic login."""
    if request.method == 'POST':
        form = UserRegisterForm(request.POST)
        if form.is_valid():
            user = form.save()
            login(request, user)
            return redirect('dashboard')
    else:
        form = UserRegisterForm()
    return render(request, 'gallery/register.html', {'form': form})

# --- Dashboard & Image Management ---
@login_required
def dashboard(request):
    user_images = ImagePost.objects.filter(user=request.user).order_by('-created_at')
    upload_form = ImagePostForm()
    if request.method == 'POST':
        upload_form = ImagePostForm(request.POST, request.FILES)
        if upload_form.is_valid():
            new_post = upload_form.save(commit=False)
            new_post.user = request.user
            new_post.save()
            return redirect('dashboard')
    context = {
        'user_images': user_images,
        'upload_form': upload_form,
        'comment_form': CommentForm(),
    }
    return render(request, 'gallery/dashboard.html', context)

@login_required
def delete_image(request, post_id):
    post = get_object_or_404(ImagePost, id=post_id, user=request.user)
    if request.method == 'POST':
        post.delete()
    return redirect('dashboard')

# --- User Search and Profile ---
@login_required
def user_search(request):
    query = request.GET.get('q')
    users = User.objects.none()
    if query:
        users = User.objects.filter(
            Q(username__icontains=query) | Q(first_name__icontains=query) | Q(last_name__icontains=query)
        ).exclude(id=request.user.id).distinct()
    return render(request, 'gallery/user_search.html', {'users': users, 'query': query})

@login_required
def user_profile(request, username):
    target_user = get_object_or_404(User, username=username)
    user_images = ImagePost.objects.filter(user=target_user).order_by('-created_at')
    context = {
        'target_user': target_user,
        'user_images': user_images,
        'comment_form': CommentForm(),
    }
    return render(request, 'gallery/user_profile.html', context)

# --- Interactions (Like/Comment) ---
@login_required
def like_post(request, post_id):
    post = get_object_or_404(ImagePost, id=post_id)
    Like.objects.get_or_create(post=post, user=request.user)
    return redirect(request.META.get('HTTP_REFERER', 'dashboard'))

@login_required
def comment_post(request, post_id):
    post = get_object_or_404(ImagePost, id=post_id)
    if request.method == 'POST':
        form = CommentForm(request.POST)
        if form.is_valid():
            new_comment = form.save(commit=False)
            new_comment.post = post
            new_comment.user = request.user
            new_comment.save()
    return redirect(request.META.get('HTTP_REFERER', 'dashboard'))</code></pre>
            </div>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-primary text-white">
            <h2 class="h4 mb-0">üîó 7. URL Routing</h2>
        </div>
        <div class="card-body">
            <h5>**Project URLs - `django_gallery/urls.py`:**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-python">from django.contrib import admin
from django.urls import path, include
from django.conf import settings
from django.conf.urls.static import static

urlpatterns = [
    path('admin/', admin.site.urls),
    path('', include('gallery.urls')),
    path('accounts/', include('django.contrib.auth.urls')),
]

# For serving uploaded media files in development
if settings.DEBUG:
    urlpatterns += static(settings.MEDIA_URL, document_root=settings.MEDIA_ROOT)</code></pre>
            </div>

            <h5>**App URLs - `gallery/urls.py`:**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-python">from django.urls import path
from . import views

urlpatterns = [
    path('register/', views.register, name='register'),
    path('dashboard/', views.dashboard, name='dashboard'),
    path('image/delete/&lt;int:post_id>/', views.delete_image, name='delete_image'),
    path('users/search/', views.user_search, name='user_search'),
    path('users/&lt;str:username>/', views.user_profile, name='user_profile'),
    path('post/&lt;int:post_id>/like/', views.like_post, name='like_post'),
    path('post/&lt;int:post_id>/comment/', views.comment_post, name='comment_post'),
    path('', views.dashboard, name='home'),
]</code></pre>
            </div>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-dark text-white">
            <h2 class="h4 mb-0">üé® 8. Templates (HTML)</h2>
        </div>
        <div class="card-body">
            <p>Create the necessary **`templates/`** directory at the project root and the **`gallery/`** and **`registration/`** subfolders inside it.</p>
            
            <div class="accordion" id="templateAccordion">
                
                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingBase">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseBase" aria-expanded="false" aria-controls="collapseBase">
                            8.1 Base Layout ‚Äî <code>templates/base.html</code>
                        </button>
                    </h2>
                    <div id="collapseBase" class="accordion-collapse collapse" aria-labelledby="headingBase" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;Django Gallery&lt;/title&gt;
    &lt;link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"&gt;
    &lt;style&gt;
        .image-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 15px;
        }
        .image-card {
            border: 1px solid #ddd;
            border-radius: 5px;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0,0,0,0.05);
        }
        .image-card img {
            width: 100%;
            height: auto;
            max-height: 300px;
            object-fit: cover;
        }
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;nav class="navbar navbar-expand-lg navbar-dark bg-dark"&gt;
        &lt;div class="container"&gt;
            &lt;a class="navbar-brand" href="{% url 'dashboard' %}"&gt;üì∏ Django Gallery&lt;/a&gt;
            &lt;div class="collapse navbar-collapse"&gt;
                &lt;ul class="navbar-nav me-auto mb-2 mb-lg-0"&gt;
                    &lt;li class="nav-item"&gt;
                        &lt;a class="nav-link" href="{% url 'user_search' %}"&gt;Search Users&lt;/a&gt;
                    &lt;/li&gt;
                &lt;/ul&gt;
                &lt;ul class="navbar-nav ms-auto"&gt;
                    {% if user.is_authenticated %}
                        &lt;li class="nav-item"&gt;
                            &lt;span class="nav-link text-white"&gt;Welcome, {{ user.username }}&lt;/span&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link btn btn-danger btn-sm ms-2" href="{% url 'logout' %}"&gt;Logout&lt;/a&gt;
                        &lt;/li&gt;
                    {% else %}
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link" href="{% url 'login' %}"&gt;Login&lt;/a&gt;
                        &lt;/li&gt;
                        &lt;li class="nav-item"&gt;
                            &lt;a class="nav-link btn btn-primary btn-sm ms-2" href="{% url 'register' %}"&gt;Sign Up&lt;/a&gt;
                        &lt;/li&gt;
                    {% endif %}
                &lt;/ul&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/nav&gt;
    &lt;div class="container mt-4"&gt;
        {% block content %}{% endblock %}
    &lt;/div&gt;
    &lt;script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"&gt;&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingComments">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseComments" aria-expanded="false" aria-controls="collapseComments">
                            8.2 Comment Snippet ‚Äî <code>templates/gallery/includes/comments.html</code>
                        </button>
                    </h2>
                    <div id="collapseComments" class="accordion-collapse collapse" aria-labelledby="headingComments" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">&lt;div class="mt-2"&gt;
    &lt;h6 class="mt-2"&gt;Interactions:&lt;/h6&gt;
    &lt;div class="mb-2"&gt;
        {% with user_has_liked=post.likes.filter(user=request.user).exists %}
            {% if user_has_liked %}
                &lt;a href="#" class="btn btn-warning btn-sm disabled"&gt;Liked!&lt;/a&gt;
            {% else %}
                &lt;a href="{% url 'like_post' post.id %}" class="btn btn-primary btn-sm"&gt;Like&lt;/a&gt;
            {% endif %}
            &lt;span class="ms-2 badge bg-secondary"&gt;{{ post.likes.count }} Likes&lt;/span&gt;
            &lt;span class="ms-2 badge bg-secondary"&gt;{{ post.comments.count }} Comments&lt;/span&gt;
        {% endwith %}
    &lt;/div&gt;
    &lt;ul class="list-unstyled small mt-2"&gt;
        {% for comment in post.comments.all|slice:":3" %}
            &lt;li class="mb-1"&gt;&lt;strong&gt;{{ comment.user.username }}:&lt;/strong&gt; {{ comment.text }}&lt;/li&gt;
        {% empty %}
            &lt;li&gt;No comments yet.&lt;/li&gt;
        {% endfor %}
    &lt;/ul&gt;
    &lt;form method="POST" action="{% url 'comment_post' post.id %}" class="mt-2"&gt;
        {% csrf_token %}
        &lt;div class="input-group input-group-sm"&gt;
            {{ comment_form.text }}
            &lt;button type="submit" class="btn btn-success btn-sm"&gt;Post&lt;/button&gt;
        &lt;/div&gt;
    &lt;/form&gt;
&lt;/div&gt;</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingDashboard">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseDashboard" aria-expanded="false" aria-controls="collapseDashboard">
                            8.3 Dashboard ‚Äî <code>templates/gallery/dashboard.html</code>
                        </button>
                    </h2>
                    <div id="collapseDashboard" class="accordion-collapse collapse" aria-labelledby="headingDashboard" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">{% extends "base.html" %}
{% block content %}
&lt;h2&gt;Hello, {{ user.username }}! Your Dashboard&lt;/h2&gt;
&lt;div class="row"&gt;
    &lt;div class="col-md-4"&gt;
        &lt;div class="card mb-4"&gt;
            &lt;div class="card-header bg-success text-white"&gt;Upload New Image&lt;/div&gt;
            &lt;div class="card-body"&gt;
                &lt;form method="POST" enctype="multipart/form-data"&gt;
                    {% csrf_token %}
                    {{ upload_form.as_p }}
                    &lt;button type="submit" class="btn btn-success w-100 mt-3"&gt;Upload&lt;/button&gt;
                &lt;/form&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="col-md-8"&gt;
        &lt;h3&gt;Your Posts&lt;/h3&gt;
        &lt;div class="image-grid"&gt;
            {% for post in user_images %}
                &lt;div class="image-card p-2"&gt;
                    &lt;img src="{{ post.image.url }}" class="img-fluid" alt="{{ post.caption }}"&gt;
                    &lt;p class="mt-2"&gt;&lt;strong&gt;{{ post.caption }}&lt;/strong&gt;&lt;/p&gt;
                    &lt;p class="text-muted"&gt;&lt;small&gt;Posted: {{ post.created_at|date:"M d, Y" }}&lt;/small&gt;&lt;/p&gt;
                    &lt;form method="POST" action="{% url 'delete_image' post.id %}" class="d-inline float-end"&gt;
                        {% csrf_token %}
                        &lt;button type="submit" class="btn btn-danger btn-sm" onclick="return confirm('Are you sure you want to delete this image?')"&gt;Delete&lt;/button&gt;
                    &lt;/form&gt;
                    {% include "gallery/includes/comments.html" with post=post comment_form=comment_form %}
                &lt;/div&gt;
            {% empty %}
                &lt;div class="alert alert-info w-100"&gt;You haven't uploaded any images yet. Use the form on the left!&lt;/div&gt;
            {% endfor %}
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock content %}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingRegister">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseRegister" aria-expanded="false" aria-controls="collapseRegister">
                            8.4 Registration ‚Äî <code>templates/gallery/register.html</code>
                        </button>
                    </h2>
                    <div id="collapseRegister" class="accordion-collapse collapse" aria-labelledby="headingRegister" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">{% extends "base.html" %}
{% block content %}
&lt;div class="row justify-content-center"&gt;
    &lt;div class="col-md-6"&gt;
        &lt;div class="card shadow-sm mt-5"&gt;
            &lt;div class="card-header bg-primary text-white"&gt;&lt;h3 class="mb-0"&gt;Sign Up&lt;/h3&gt;&lt;/div&gt;
            &lt;div class="card-body"&gt;
                &lt;form method="POST"&gt;
                    {% csrf_token %}
                    {% for field in form %}
                        &lt;div class="mb-3"&gt;
                            &lt;label for="{{ field.id_for_label }}" class="form-label"&gt;{{ field.label }}&lt;/label&gt;
                            &lt;!-- NOTE: The |add_class filter requires 'django-widget-tweaks'. If not installed, just use {{ field }} --&gt;
                            {{ field|add_class:"form-control" }}
                            {% if field.errors %}
                                &lt;div class="text-danger small"&gt;{{ field.errors }}&lt;/div&gt;
                            {% endif %}
                        &lt;/div&gt;
                    {% endfor %}
                    &lt;button type="submit" class="btn btn-success w-100 mt-3"&gt;Register Account&lt;/button&gt;
                &lt;/form&gt;
            &lt;/div&gt;
            &lt;div class="card-footer text-center"&gt;
                Already have an account? &lt;a href="{% url 'login' %}"&gt;Log In Here&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock content %}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingLogin">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseLogin" aria-expanded="false" aria-controls="collapseLogin">
                            8.5 Login ‚Äî <code>templates/registration/login.html</code>
                        </button>
                    </h2>
                    <div id="collapseLogin" class="accordion-collapse collapse" aria-labelledby="headingLogin" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">{% extends "base.html" %}
{% block content %}
&lt;div class="row justify-content-center"&gt;
    &lt;div class="col-md-6"&gt;
        &lt;div class="card shadow-sm mt-5"&gt;
            &lt;div class="card-header bg-dark text-white"&gt;&lt;h3 class="mb-0"&gt;Login&lt;/h3&gt;&lt;/div&gt;
            &lt;div class="card-body"&gt;
                {% if form.errors %}
                    &lt;div class="alert alert-danger"&gt;
                        Your username and password didn't match. Please try again.
                    &lt;/div&gt;
                {% endif %}
                &lt;form method="POST"&gt;
                    {% csrf_token %}
                    &lt;div class="mb-3"&gt;
                        &lt;label for="{{ form.username.id_for_label }}" class="form-label"&gt;Username&lt;/label&gt;
                        &lt;input type="text" name="{{ form.username.name }}" id="{{ form.username.id_for_label }}" class="form-control" required&gt;
                    &lt;/div&gt;
                    &lt;div class="mb-3"&gt;
                        &lt;label for="{{ form.password.id_for_label }}" class="form-label"&gt;Password&lt;/label&gt;
                        &lt;input type="password" name="{{ form.password.name }}" id="{{ form.password.id_for_label }}" class="form-control" required&gt;
                    &lt;/div&gt;
                    &lt;input type="hidden" name="next" value="{{ next }}"&gt;
                    &lt;button type="submit" class="btn btn-primary w-100 mt-3"&gt;Log In&lt;/button&gt;
                &lt;/form&gt;
            &lt;/div&gt;
            &lt;div class="card-footer text-center"&gt;
                Don't have an account? &lt;a href="{% url 'register' %}"&gt;Sign Up&lt;/a&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock content %}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingSearch">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSearch" aria-expanded="false" aria-controls="collapseSearch">
                            8.6 User Search ‚Äî <code>templates/gallery/user_search.html</code>
                        </button>
                    </h2>
                    <div id="collapseSearch" class="accordion-collapse collapse" aria-labelledby="headingSearch" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">{% extends "base.html" %}
{% block content %}
&lt;div class="row justify-content-center"&gt;
    &lt;div class="col-lg-8"&gt;
        &lt;h2 class="mb-4"&gt;üîç Find Other Users&lt;/h2&gt;
        &lt;form method="GET" action="{% url 'user_search' %}" class="mb-4"&gt;
            &lt;div class="input-group input-group-lg"&gt;
                &lt;input type="text" name="q" class="form-control" placeholder="Search by username, first name, or last name..." value="{{ query|default_if_none:'' }}"&gt;
                &lt;button class="btn btn-primary" type="submit"&gt;Search&lt;/button&gt;
            &lt;/div&gt;
        &lt;/form&gt;
        {% if query and users %}
            &lt;h4&gt;Search Results for "{{ query }}" ({{ users|length }} found)&lt;/h4&gt;
            &lt;ul class="list-group"&gt;
                {% for user_obj in users %}
                    &lt;li class="list-group-item d-flex justify-content-between align-items-center"&gt;
                        &lt;div&gt;
                            &lt;strong&gt;{{ user_obj.username }}&lt;/strong&gt;
                             {% if user_obj.first_name and user_obj.last_name %}
                                &lt;span class="text-muted small"&gt;({{ user_obj.first_name }} {{ user_obj.last_name }})&lt;/span&gt;
                            {% endif %}
                        &lt;/div&gt;
                        &lt;a href="{% url 'user_profile' username=user_obj.username %}" class="btn btn-outline-info btn-sm"&gt;View Profile&lt;/a&gt;
                    &lt;/li&gt;
                {% endfor %}
            &lt;/ul&gt;
        {% elif query %}
            &lt;div class="alert alert-warning"&gt;No users found matching "{{ query }}".&lt;/div&gt;
        {% else %}
            &lt;div class="alert alert-info"&gt;Enter a name or username above to start searching.&lt;/div&gt;
        {% endif %}
    &lt;/div&gt;
&lt;/div&gt;
{% endblock content %}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <h2 class="accordion-header" id="headingProfile">
                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseProfile" aria-expanded="false" aria-controls="collapseProfile">
                            8.7 User Profile ‚Äî <code>templates/gallery/user_profile.html</code>
                        </button>
                    </h2>
                    <div id="collapseProfile" class="accordion-collapse collapse" aria-labelledby="headingProfile" data-bs-parent="#templateAccordion">
                        <div class="accordion-body p-0">
                            <div class="code-container">
                                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                                <pre><code class="language-html">{% extends "base.html" %}
{% block content %}
&lt;div class="row"&gt;
    &lt;div class="col-12 mb-4"&gt;
        &lt;h2 class="display-5"&gt;üë§ {{ target_user.username }}'s Gallery&lt;/h2&gt;
        {% if target_user.first_name and target_user.last_name %}
            &lt;p class="lead text-muted"&gt;{{ target_user.first_name }} {{ target_user.last_name }}&lt;/p&gt;
        {% endif %}
        &lt;hr&gt;
    &lt;/div&gt;
    &lt;div class="col-12"&gt;
        &lt;h3&gt;Posts by {{ target_user.username }} ({{ user_images|length }})&lt;/h3&gt;
        &lt;div class="image-grid"&gt;
            {% for post in user_images %}
                &lt;div class="image-card p-2"&gt;
                    &lt;img src="{{ post.image.url }}" class="img-fluid" alt="{{ post.caption }}"&gt;
                    &lt;p class="mt-2"&gt;&lt;strong&gt;{{ post.caption }}&lt;/strong&gt;&lt;/p&gt;
                    &lt;p class="text-muted"&gt;&lt;small&gt;Posted: {{ post.created_at|date:"M d, Y" }}&lt;/small&gt;&lt;/p&gt;
                    {% include "gallery/includes/comments.html" with post=post comment_form=comment_form %}
                &lt;/div&gt;
            {% empty %}
                &lt;div class="alert alert-info w-100"&gt;
                    {{ target_user.username }} has not uploaded any images yet.
                &lt;/div&gt;
            {% endfor %}
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;
{% endblock content %}</code></pre>
                            </div>
                        </div>
                    </div>
                </div>

            </div> <div class="alert alert-info mt-4">
                <strong>Note:</strong> The **`|add_class:"form-control"`** filter in `register.html` requires the **`django-widget-tweaks`** package. If you don't install it, remove the **`|add_class:"form-control"`** part.
            </div>
        </div>
    </div>

    <div class="card section-card">
        <div class="card-header bg-success text-white">
            <h2 class="h4 mb-0">üöÄ 9. Final Steps</h2>
        </div>
        <div class="card-body">
            <h5>**Create Superuser:**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-bash">python manage.py createsuperuser</code></pre>
            </div>
            
            <h5>**Start the Server:**</h5>
            <div class="code-container">
                <button class="btn btn-sm btn-outline-info copy-btn" onclick="copyCode(this)">Copy</button>
                <pre><code class="language-bash">python manage.py runserver</code></pre>
            </div>

            <p class="lead mt-4 text-center">
                ‚úÖ **Done!** Visit <a href="http://127.0.0.1:8000/register/" target="_blank">http://127.0.0.1:8000/register/</a> to start using your Django Social Photo Gallery!
            </p>
        </div>
    </div>

</div>

<script>
    function copyCode(button) {
        // Get the pre element next to the button
        const pre = button.nextElementSibling;
        const code = pre.textContent.trim();

        // Use modern clipboard API
        navigator.clipboard.writeText(code).then(() => {
            const originalText = button.textContent;
            button.textContent = 'Copied!';
            setTimeout(() => {
                button.textContent = originalText;
            }, 1000);
        }).catch(err => {
            console.error('Could not copy text: ', err);
            alert('Failed to copy code. Please select and copy manually.');
        });
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
